<div nz-row class="mgbt20">
  <div nz-col nzSpan="12">
    <h3>Nhập / Xuất kho</h3>
  </div>
  <div nz-col nzSpan="12">
    <div class="float-right">
      <button style="margin-right: 5px;" (click)="handleCorU({transaction_type_id : 0})"  nz-button nzType="primary"><i nz-icon nzType="upload" nzTheme="outline"></i>
        Xuất / Chuyển kho
      </button>
      <button (click)="handleCorU({transaction_type_id : 1})" nz-button nzType="danger"><i nz-icon nzType="import" nzTheme="outline"></i>
        Nhập kho </button>
    </div>
  </div>
</div>
<div class="box box-success">
  <div class="box-header">
    <div nz-form [nzLayout]="'inline'">
      <nz-form-item>
        <nz-form-control>
          <nz-input-group nzPrefixIcon="key">
            <nz-range-picker [nzFormat]="dateFormat" [(ngModel)]="filter.date"></nz-range-picker>
          </nz-input-group>
        </nz-form-control>
      </nz-form-item>

      <nz-form-item>
        <nz-form-control>
          <nz-input-group >
            <nz-select style="width: 140px;"  nzShowSearch nzAllowClear nzPlaceHolder="Hàng hóa" [(ngModel)]="filter.product_id">
              <nz-option nzLabel="Tất cả hàng hóa" nzValue="0"></nz-option>
              <nz-option *ngFor="let item of products"  nzLabel="{{ item.name }}" nzValue="{{ item.id }}"></nz-option>
            </nz-select>
          </nz-input-group>
        </nz-form-control>
      </nz-form-item>

      <nz-form-item>
        <nz-form-control>
          <nz-input-group >
            <nz-select style="width: 140px;" nzShowSearch nzAllowClear nzPlaceHolder="Kho" [(ngModel)]="filter.dest_id">
              <nz-option nzLabel="Tất cả kho" nzValue="0"></nz-option>
              <nz-option *ngFor="let item of warehouses"  nzLabel="{{ item.name }}" nzValue="{{ item.id }}"></nz-option>

            </nz-select>
          </nz-input-group>
        </nz-form-control>
      </nz-form-item>
      
      <nz-form-item>
        <nz-form-control>
          <button nz-button (click)="filterData()" nzType="primary">Hiển thị</button>
        </nz-form-control>
      </nz-form-item>
    </div>
  </div>

  <div class="box-body">
    <div class="table-responsive">
      <nz-table nzBordered #ajaxTable nzShowSizeChanger [nzFrontPagination]="false" [nzData]="listOfData"
        [nzLoading]="loading" [nzTotal]="total" [(nzPageIndex)]="pageIndex" [(nzPageSize)]="pageSize">
        <thead>
          <tr>
            <th width="3%" class="text-center">STT</th>
            <th width="5%" class="mw-100 text-center">
              Số phiếu
            </th>
            <th width="12%" class="mw-100 text-center">
              Ngày tạo
            </th>
            <th width="10%" class="text-center mw-100">
              Loại phiếu
            </th>
            <th width="10%" class="mw-100 text-center">
              Kho xuất
            </th>
            <th width="10%" class="mw-100 text-center">
              Kho nhận
            </th>
            <th width="12%" class="mw-100 text-center">
              Ngày nhận
            </th>

            <th width="15%" class="mw-100">
              Ghi chú
            </th>
            <th width="10%" class="mw-100 text-center">
              trạng thái
            </th>
            <th width="10%" class="text-center mw-100"><span>Hành động</span></th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let data of ajaxTable.data;let i = index">
            <td class="text-center">{{ i+ 1}}</td>
            <td class="text-center">{{ data.id }}</td>
            <td class="text-center">{{ formatDate(data.created_date,'DD/MM/YYYY HH:mm') }}</td>
            <td class="text-center">
              <span class="badge" [ngClass]="{
                'badge-primary': data.transaction_type_id ==1,
                'badge-success': data.transaction_type_id ==2,
                'badge-warning': data.transaction_type_id ==3,
                'badge-default': data.transaction_type_id ==4  }">
                {{ data.transaction_type_name }}
              </span>
            </td>
            <td class="text-center">{{ data.source_name  }} </td>
            <td class="text-center">{{ data.dest_name  }}</td>
            <td class="text-center">{{ formatDate(data.received_date,'DD/MM/YYYY HH:mm')  }}</td>
            <td>{{ data.note  }}</td>
            <td class="text-center">
              <span class="badge" [ngClass]="{
                'badge-primary': data.status_id ==1,
                'badge-success': data.status_id ==2,
                'badge-warning': data.status_id ==3,
                'badge-default': data.status_id ==4  }">
                {{ data.status_name  }}
              </span>
            </td>
            <td class="cttd" class="text-center">
              <div zn-row>
                <i nz-icon nzType="edit" nz-tooltip nzTitle="Sửa phiếu" class="iconAction text-warning"
                  (click)="handleCorU(data)" nzTheme="outline"></i>

                <i nz-icon nzType="delete" nz-tooltip nzTitle="Xóa phiếu" class="iconAction text-danger"
                  (click)="confirmDelete(data.id)" nzTheme="outline"></i>
              </div>
            </td>
          </tr>
        </tbody>
      </nz-table>
    </div>
  </div>
</div>

<app-input-wh *ngIf="isVisible" [dataEdit]="dataEdit" [isVisible]="isVisible" (closeModal)="closeModal($event)"
  class="fade in">
</app-input-wh>